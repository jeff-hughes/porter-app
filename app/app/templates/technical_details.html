{% extends "base.html" %}

{% block title %}Notes and Technical Details{% endblock %}

{% block body_class %}technical_details{% endblock %}

{% block content %}
    <h2>Notes and Technical Details</h2>
    <p>The online version of this family history was first generated by scanning in the typewritten version, and using optical character recognition (OCR) &ndash; via <a href="https://github.com/kyper999/pyocr">pyocr</a> and <a href="https://github.com/tesseract-ocr/tesseract">tesseract</a> &ndash; to convert the typed pages into plain text. (The pages were first converted from PDF to jpeg images using the <a href="https://python-pillow.org/">Python Image Library, or Pillow</a>.) This resulted in mostly usable text, but still required fairly significant manual cleaning to correct errors.</p>

    <p>Creating a script to properly parse all of the details in the text proved challenging, and ultimately the text was manually inputted into three CSV files, designating <em>people</em>, <em>children</em>, and <em>marriages</em>.</p>
    
    <p><strong>Note:</strong> During this process, gender was added as an additional piece of information for each person. However, adding this information involved making some assumptions. First, while many names are largely masculine or feminine, in some cases a gender-neutral name meant that I had to guess a person&rsquo;s gender based on the name of their spouse, which may have led to inaccuracies. Second, in all cases, the assumption is that individuals identify with the gender associated with their birth name, which may not always be the case. Individuals may be transgender, non-binary, or otherwise not self-identify with the gender that is stated here. (If you are aware of any inaccuracies in this regard, <a href="{{ url_for('report') }}">please let me know</a> and I am happy to correct it.) Gender can have such a large role to play in people&rsquo;s lives, so it felt important to include here; but it is important to keep the assumptions about this data in mind.</p>

    <p>Initially, data was inputted into a <a href="https://neo4j.com">Neo4j</a> database, a graph database that stores data as a network of nodes and edges (i.e., connections between nodes). Given that a family tree constitutes a graph structure, this seemed like a natural fit. However, after running some performance benchmarks, <a href="https://www.postgresql.org">PostgreSQL</a> still turned out to provide performance speedups (reductions in latency of ~50-70%) over Neo4j. Note that these benchmarks included the performance of both the database and the Python packages used to interface with the database, and were also highly specific to the particular needs of this app. In addition, in absolute terms Neo4j still provided results on the order of hundredths of a second&mdash;for this relatively small amount of data, the choice of database is largely inconsequential. However, PostgreSQL was chosen in the end in order to also be able to export the data to CSV format in a more readily consumable layout.</p>

    <p>The app itself uses <a href="https://flask.palletsprojects.com/en/1.1.x/">Flask</a>, a Python web framework, using <a href="https://www.psycopg.org">psycopg2</a> to access the Postgres database. The graphical family tree representations are drawn using <a href="https://github.com/ErikGartner/dTree">dTree</a>. Both the Flask app and the database are set up in <a href="https://www.docker.com/">Docker</a> containers for easier maintenance and dependency management.</p>

    <p>Code for the app is available on <a href="https://github.com/jeff-hughes/portertree">Github</a>.</p>
{% endblock %}